<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Generate an object of class RETRA from a data frame containing trajectory
states to define representative trajectories in Ecological Dynamic Regimes (EDR)."><title>Define representative trajectories from trajectory features — define_retra • ecoregime</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Define representative trajectories from trajectory features — define_retra"><meta property="og:description" content="Generate an object of class RETRA from a data frame containing trajectory
states to define representative trajectories in Ecological Dynamic Regimes (EDR)."><meta property="og:image" content="https://mspinillos.github.io/ecoregime/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">ecoregime</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.3.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/EDR_framework.html">Ecological Dynamic Regime framework</a>
    <a class="dropdown-item" href="../articles/Resilience.html">Ecological resilience to pulse disturbances</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/MSPinillos/ecoregime/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Define representative trajectories from trajectory features</h1>
      <small class="dont-index">Source: <a href="https://github.com/MSPinillos/ecoregime/blob/HEAD/R/define_retra.R" class="external-link"><code>R/define_retra.R</code></a></small>
      <div class="d-none name"><code>define_retra.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Generate an object of class <code>RETRA</code> from a data frame containing trajectory
states to define representative trajectories in Ecological Dynamic Regimes (EDR).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">define_retra</span><span class="op">(</span><span class="va">data</span>, d <span class="op">=</span> <span class="cn">NULL</span>, trajectories <span class="op">=</span> <span class="cn">NULL</span>, states <span class="op">=</span> <span class="cn">NULL</span>, retra <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>data</dt>
<dd><p>A data frame of four columns indicating identifiers for the new
representative trajectories, the individual trajectories or sites to which the
states belong, the order of the states in the individual trajectories, and the
identifier of the representative trajectory to which the states belong (only
if <code>!is.null(retra)</code>). Alternatively, 'data' can be a vector or a list of
character vectors including the sequence of segments forming the new
representative trajectory. See Details for further clarifications to define
<code>data</code>.</p></dd>


<dt>d</dt>
<dd><p>Either a symmetric matrix or an object of class <code><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></code> containing the
dissimilarities between each pair of states of all trajectories in the EDR.
If <code>NULL</code> (default), the length (<code>Length</code>) of the new representative trajectories
and the distances between states of different trajectories or sites (<code>Link_distance</code>)
are not calculated.</p></dd>


<dt>trajectories</dt>
<dd><p>Only needed if <code>!is.null(d)</code>. Vector indicating the
trajectory or site to which each state in <code>d</code> belongs.</p></dd>


<dt>states</dt>
<dd><p>Only needed if <code>!is.null(d)</code>. Vector of integers indicating the
order of the states in <code>d</code> for each trajectory.</p></dd>


<dt>retra</dt>
<dd><p>Object of class <code>RETRA</code> returned from <code><a href="retra_edr.html">retra_edr()</a></code>. If <code>NULL</code>
(default), <code>minSegs</code> and <code>Seg_density</code> are not provided for the new representative
trajectories.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>An object of class <code>RETRA</code>, which is a list of length equal to the number of
representative trajectories defined. For each trajectory, the following
information is returned:</p><dl><dt><code>minSegs</code></dt>
<dd><p>Value of the <code>minSegs</code> parameter used in <code><a href="retra_edr.html">retra_edr()</a></code>. If <code>retra</code>
is <code>NULL</code>, <code>minSegs</code> = <code>NA</code>.</p></dd>

<dt><code>Segments</code></dt>
<dd><p>Vector of strings including the sequence of segments forming the
representative trajectory. Each segment is identified by a string of the form
<code>traj[st1-st2]</code>, where <code>traj</code> is the identifier of the original trajectory to
which the segment belongs and <code>st1</code> and <code>st2</code> are identifiers of the initial
and final states defining the segment. The same format <code>traj[st1-st2]</code> is
maintained when only one state of an individual trajectory is considered
(<code>st1</code> = <code>st2</code>). <code>traj</code>, <code>st1</code>, and <code>st2</code> are recycled from <code>data</code>.</p></dd>

<dt><code>Size</code></dt>
<dd><p>Integer indicating the number of states forming the representative
trajectory.</p></dd>

<dt><code>Length</code></dt>
<dd><p>Numeric value indicating the length of the representative trajectory,
calculated as the sum of the dissimilarities in <code>d</code> between every pair of
consecutive states. If <code>d</code> is <code>NULL</code>, <code>Length</code> = <code>NA</code>.</p></dd>

<dt><code>Link_distance</code></dt>
<dd><p>Data frame of two columns indicating artificial links between
two segments (<code>Link</code>) and the dissimilarity between the connected states
(<code>Distance</code>). When two representative segments are linked by a common state or
by two consecutive states of the same trajectory, the link distance is zero or
equal to the length of a real segment, respectively. In both cases, the link
is not considered in the returned data frame. If <code>d</code> is <code>NULL</code>, <code>Link_distance</code>
= <code>NA</code>.</p></dd>

<dt><code>Seg_density</code></dt>
<dd><p>Data frame of two columns and one row for each representative
segment. <code>Density</code> contains the number of segments in the EDR that is represented
by each segment of the representative trajectory. <code>kdTree_depth</code> contains the
depth of the k-d tree for each leaf represented by the corresponding segment.
That is, the number of partitions of the ordination space until finding a region
with <code>minSegs</code> segments or less. If <code>retra</code> is <code>NULL</code>, <code>Seg_density</code> = <code>NA</code>.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Each representative trajectory returned by the function <code><a href="retra_edr.html">retra_edr()</a></code> corresponds
to the longest sequence of representative segments that can be linked according
to the criteria defined in the RETRA-EDR algorithm (Sánchez-Pinillos et al.,
2023). One could be interested in splitting the obtained trajectories, considering
only a fraction of the returned trajectories, or defining representative
trajectories following different criteria than those in RETRA-EDR.
The function <code>define_retra()</code> allows generating an object of class <code>RETRA</code> that
can be used in other functions of <code>ecoregime</code> (e.g., <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code>).</p>
<p>For that, it is necessary to provide information about the set of segments or
trajectory states that form the new representative trajectory through the
argument <code>data</code>:</p><ul><li><p><code>data</code> can be defined as a <strong>data frame</strong> with as many rows as the number of
states in all representative trajectories and the following columns:</p><dl><dt><code>RT</code></dt>
<dd><p>A string indicating the identifier of the new representative trajectories.
Each identifier needs to appear as many times as the number of states forming
each representative trajectory.</p></dd>

<dt><code>RT_traj</code></dt>
<dd><p>A vector indicating the individual trajectories in the EDR to which
each state of the new representative trajectory belongs.</p></dd>

<dt><code>RT_states</code></dt>
<dd><p>A vector of integers indicating the identifier of the states
forming the new representative trajectories. Each integer must refer to the order
of the states in the individual trajectories of the EDR to which they belong.</p></dd>

<dt><code>RT_retra</code></dt>
<dd><p>Only if the new trajectories are defined from representative
trajectories returned by <code><a href="retra_edr.html">retra_edr()</a></code> (when <code>!is.null(retra)</code>). A vector of strings
indicating the representative trajectory in <code>retra</code> to which each state belongs.</p></dd>


</dl></li>
<li><p>Alternatively, <code>data</code> can be defined as either a <strong>vector</strong> (if there is one
representative trajectory) or a <strong>list of character vectors</strong> (with as many
elements as the number of representative trajectories desired) containing the
sequence of segments of the representative trajectories. In any case, each
segment needs to be specified in the form <code>traj[st1-st2]</code>, where <code>traj</code> is the
identifier of the original trajectory to which the segment belongs and <code>st1</code>
and <code>st2</code> are identifiers of the initial and final states defining the segment.
If only one state of an individual trajectory is considered to form the
representative trajectory, the corresponding segment needs to be defined as
<code>traj[st-st]</code>.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="retra_edr.html">retra_edr()</a></code> for identifying representative trajectories in EDRs through
RETRA-EDR.</p>
<p><code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> for summarizing the characteristics of the representative
trajectories.</p>
<p><code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> for plotting representative trajectories in an ordination space
representing the state space of the EDR.</p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Martina Sánchez-Pinillos</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Example 1 -----------------------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co"># Define representative trajectories from the outputs of retra_edr().</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Identify representative trajectories using retra_edr()</span></span></span>
<span class="r-in"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="va">EDR_data</span><span class="op">$</span><span class="va">EDR1</span><span class="op">$</span><span class="va">state_dissim</span></span></span>
<span class="r-in"><span><span class="va">trajectories</span> <span class="op">&lt;-</span> <span class="va">EDR_data</span><span class="op">$</span><span class="va">EDR1</span><span class="op">$</span><span class="va">abundance</span><span class="op">$</span><span class="va">traj</span></span></span>
<span class="r-in"><span><span class="va">states</span> <span class="op">&lt;-</span> <span class="va">EDR_data</span><span class="op">$</span><span class="va">EDR1</span><span class="op">$</span><span class="va">abundance</span><span class="op">$</span><span class="va">state</span></span></span>
<span class="r-in"><span><span class="va">old_retra</span> <span class="op">&lt;-</span> <span class="fu"><a href="retra_edr.html">retra_edr</a></span><span class="op">(</span>d <span class="op">=</span> <span class="va">d</span>, trajectories <span class="op">=</span> <span class="va">trajectories</span>, states <span class="op">=</span> <span class="va">states</span>,</span></span>
<span class="r-in"><span>                       minSegs <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># retra_edr() returns three representative trajectories</span></span></span>
<span class="r-in"><span><span class="va">old_retra</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $T1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $T1$minSegs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $T1$Segments</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "28[1-2]" "28[2-3]"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $T1$Size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $T1$Length</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.2669408</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $T1$Link_distance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $T1$Seg_density</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Density kdTree_depth</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28[1-2]       7            4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28[2-3]       6            5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $T2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $T2$minSegs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $T2$Segments</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "28[1-2]" "30[2-3]" "5[3-4]"  "15[1-2]" "4[2-3]"  "4[3-4]"  "1[1-2]" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [8] "14[2-3]"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $T2$Size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $T2$Length</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.9270207</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $T2$Link_distance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                Link    Distance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 28[1-2] - 30[2-3] 0.074626866</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  30[2-3] - 5[3-4] 0.045685279</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  5[3-4] - 15[1-2] 0.144278607</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  15[1-2] - 4[2-3] 0.035175879</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   4[3-4] - 1[1-2] 0.010000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  1[1-2] - 14[2-3] 0.004926108</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $T2$Seg_density</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Density kdTree_depth</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28[1-2]       7            4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30[2-3]       6            5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5[3-4]        6            5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15[1-2]       6            6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4[2-3]        7            7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4[3-4]        9            5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1[1-2]        9            3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14[2-3]       7            6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $T3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $T3$minSegs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $T3$Segments</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "6[1-2]"  "5[3-4]"  "15[1-2]" "4[2-3]"  "4[3-4]"  "1[1-2]"  "14[2-3]"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $T3$Size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $T3$Length</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.6756596</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $T3$Link_distance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               Link    Distance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  6[1-2] - 5[3-4] 0.020202020</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 5[3-4] - 15[1-2] 0.144278607</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 15[1-2] - 4[2-3] 0.035175879</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  4[3-4] - 1[1-2] 0.010000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 1[1-2] - 14[2-3] 0.004926108</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $T3$Seg_density</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Density kdTree_depth</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6[1-2]        8            5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5[3-4]        6            5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15[1-2]       6            6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4[2-3]        7            7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4[3-4]        9            5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1[1-2]        9            3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14[2-3]       7            6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "RETRA"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Keep the last five segments of trajectories "T2" and "T3"</span></span></span>
<span class="r-in"><span><span class="va">selected_segs</span> <span class="op">&lt;-</span> <span class="va">old_retra</span><span class="op">$</span><span class="va">T2</span><span class="op">$</span><span class="va">Segments</span><span class="op">[</span><span class="fl">4</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">old_retra</span><span class="op">$</span><span class="va">T2</span><span class="op">$</span><span class="va">Segments</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Identify the individual trajectories for each state...</span></span></span>
<span class="r-in"><span><span class="va">selected_segs</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "15[1-2]" "4[2-3]"  "4[3-4]"  "1[1-2]"  "14[2-3]"</span>
<span class="r-in"><span><span class="va">selected_traj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">15</span>, <span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">1</span>, <span class="fl">14</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ...and the states (in the same order as the representative trajectory).</span></span></span>
<span class="r-in"><span><span class="va">selected_states</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Generate the data frame with the format indicated in the documentation</span></span></span>
<span class="r-in"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>RT <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">selected_states</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                 RT_traj <span class="op">=</span> <span class="va">selected_traj</span>,</span></span>
<span class="r-in"><span>                 RT_states <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">selected_states</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                 RT_retra <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"T2"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">selected_states</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Remove duplicates (trajectory 4, state 3)</span></span></span>
<span class="r-in"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Generate a RETRA object using define_retra()</span></span></span>
<span class="r-in"><span><span class="va">new_retra</span> <span class="op">&lt;-</span> <span class="fu">define_retra</span><span class="op">(</span>data <span class="op">=</span> <span class="va">df</span>,</span></span>
<span class="r-in"><span>                          d <span class="op">=</span> <span class="va">d</span>,</span></span>
<span class="r-in"><span>                          trajectories <span class="op">=</span> <span class="va">trajectories</span>,</span></span>
<span class="r-in"><span>                          states <span class="op">=</span> <span class="va">states</span>,</span></span>
<span class="r-in"><span>                          retra <span class="op">=</span> <span class="va">old_retra</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 2 -----------------------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co"># Define representative trajectories from sequences of segments</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Select all segments in T1, split T2 into two new trajectories, and include</span></span></span>
<span class="r-in"><span><span class="co"># a trajectory composed of states belonging to trajectories "5", "6", and "7"</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">old_retra</span><span class="op">$</span><span class="va">T1</span><span class="op">$</span><span class="va">Segments</span>,</span></span>
<span class="r-in"><span>             <span class="va">old_retra</span><span class="op">$</span><span class="va">T2</span><span class="op">$</span><span class="va">Segments</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>             <span class="va">old_retra</span><span class="op">$</span><span class="va">T2</span><span class="op">$</span><span class="va">Segments</span><span class="op">[</span><span class="fl">4</span><span class="op">:</span><span class="fl">8</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>             <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"5[1-2]"</span>, <span class="st">"5[2-3]"</span>, <span class="st">"7[4-4]"</span>, <span class="st">"6[4-5]"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Generate a RETRA object using define_retra()</span></span></span>
<span class="r-in"><span><span class="va">new_retra</span> <span class="op">&lt;-</span> <span class="fu">define_retra</span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>,</span></span>
<span class="r-in"><span>                          d <span class="op">=</span> <span class="va">d</span>,</span></span>
<span class="r-in"><span>                          trajectories <span class="op">=</span> <span class="va">trajectories</span>,</span></span>
<span class="r-in"><span>                          states <span class="op">=</span> <span class="va">states</span>,</span></span>
<span class="r-in"><span>                          retra <span class="op">=</span> <span class="va">old_retra</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 3 -----------------------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co"># Define two representative trajectories from individual trajectories in EDR1.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Define trajectory "A" from states in trajectories 3 and 4</span></span></span>
<span class="r-in"><span><span class="va">data_A</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>RT <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="fl">4</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                     RT_traj <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">4</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                     RT_states <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="fl">4</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Define trajectory "B" from states in trajectories 5, 6, and 7</span></span></span>
<span class="r-in"><span><span class="va">data_B</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>RT <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"B"</span>, <span class="fl">5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                     RT_traj <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">5</span>, <span class="fl">7</span>, <span class="fl">6</span>, <span class="fl">6</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                     RT_states <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compile data for both trajectories in a data frame</span></span></span>
<span class="r-in"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">data_A</span>, <span class="va">data_B</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">df</span><span class="op">$</span><span class="va">RT_states</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">RT_states</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Generate a RETRA object using define_retra()</span></span></span>
<span class="r-in"><span><span class="va">new_retra</span> <span class="op">&lt;-</span> <span class="fu">define_retra</span><span class="op">(</span>data <span class="op">=</span> <span class="va">df</span>, d <span class="op">=</span> <span class="va">EDR_data</span><span class="op">$</span><span class="va">EDR1</span><span class="op">$</span><span class="va">state_dissim</span>,</span></span>
<span class="r-in"><span>                          trajectories <span class="op">=</span> <span class="va">EDR_data</span><span class="op">$</span><span class="va">EDR1</span><span class="op">$</span><span class="va">abundance</span><span class="op">$</span><span class="va">traj</span>,</span></span>
<span class="r-in"><span>                          states <span class="op">=</span> <span class="va">EDR_data</span><span class="op">$</span><span class="va">EDR1</span><span class="op">$</span><span class="va">abundance</span><span class="op">$</span><span class="va">state</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Martina Sánchez-Pinillos.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

