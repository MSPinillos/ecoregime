<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="ecoregime">
<title>Ecological resilience to pulse disturbances • ecoregime</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Ecological resilience to pulse disturbances">
<meta property="og:description" content="ecoregime">
<meta property="og:image" content="https://mspinillos.github.io/ecoregime/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">ecoregime</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.3.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/EDR_framework.html">Ecological Dynamic Regime framework</a>
    <a class="dropdown-item" href="../articles/Resilience.html">Ecological resilience to pulse disturbances</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/MSPinillos/ecoregime/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Ecological resilience to pulse disturbances</h1>
                        <h4 data-toc-skip class="author">Martina
Sánchez-Pinillos</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/MSPinillos/ecoregime/blob/HEAD/vignettes/Resilience.Rmd" class="external-link"><code>vignettes/Resilience.Rmd</code></a></small>
      <div class="d-none name"><code>Resilience.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">1. Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<div class="section level3">
<h3 id="ecological-resilience-and-the-edr-framework">1.1. Ecological resilience and the EDR framework<a class="anchor" aria-label="anchor" href="#ecological-resilience-and-the-edr-framework"></a>
</h3>
<p><strong>Ecological resilience</strong> is defined as the ability of
ecological systems to tolerate disturbances and still maintain the same
relationships between state variables (Holling, 1973). Measuring
ecological resilience requires considering two important components: the
dynamic trends of the system, including its cyclic behaviors, and the
random forces representing positive and negative feedback relationships
between the components of the system (Holling, 1973). As such, assessing
ecological resilience must account for the system dynamic regimes.</p>
<p>An <strong>ecological dynamic regime (EDR)</strong> is defined as the
<em>fluctuations of an ecological system around some trend or average
resulting from the interaction between internal processes and external
forces that, in the absence of perturbations, keep the system within the
basin of attraction</em> (Sánchez-Pinillos et al., 2023). The main
dynamic trends characterizing an EDR are useful to identify cyclic
behaviors and other more complex dynamics, such as transient dynamics.
Additionally, the fluctuations and variability of ecological dynamics
resulting from the interaction of multiple factors define the shape,
size, and characteristics of dynamic regimes and potential domains of
attraction (Sánchez-Pinillos et al., 2024).</p>
<p>The <strong>EDR framework</strong> is a set of algorithms and metrics
to characterize and compare ecological dynamic regimes from empirical
data so they can be used as the reference to assess ecological
resilience accounting for both the dynamic trends of the system and the
feedback relationships between its components.</p>
<p>To know more about the relevance of dynamic regimes for assessing
ecological resilience, see this publication:</p>
<ul>
<li>Sánchez-Pinillos M., Dakos, V., Kéfi, S. 2024. Ecological dynamic
regimes: A key concept for assessing ecological resilience.
<em>Biological Conservation</em>. <a href="https://doi.org/10.1016/j.biocon.2023.110409" class="external-link uri">https://doi.org/10.1016/j.biocon.2023.110409</a>
</li>
</ul>
<p>Additional information about the EDR framework can be found in this
publication:</p>
<ul>
<li>Sánchez-Pinillos M., Kéfi, S., De Cáceres, M., Dakos, V. 2023.
Ecological Dynamic Regimes: Identification, characterization, and
comparison. <em>Ecological Monographs</em>. <a href="https://doi.org/10.1002/ecm.1589" class="external-link uri">https://doi.org/10.1002/ecm.1589</a>
</li>
</ul>
</div>
<div class="section level3">
<h3 id="about-this-vignette">1.2. About this vignette<a class="anchor" aria-label="anchor" href="#about-this-vignette"></a>
</h3>
<p>This vignette aims to illustrate how ecological resilience can be
assessed using the EDR framework implemented in <code>ecoregime</code>.
In particular, this vignette focuses on the quantitative indices
proposed in Sánchez-Pinillos et al. (2024) and their geometric
rationale, taking ecological dynamic regimes as the reference to
evaluate ecological resilience.</p>
<p>You can install <code>ecoregime</code> directly from CRAN or from my
GitHub account (development version):</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("ecoregime")</span></span>
<span><span class="co"># devtools::install_github(repo = "MSPinillos/ecoregime", dependencies = T, build_vignettes = T)</span></span></code></pre></div>
<p>Once you have installed <code>ecoregime</code> you will have to load
it:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mspinillos.github.io/ecoregime/">ecoregime</a></span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/citation.html" class="external-link">citation</a></span><span class="op">(</span><span class="st">"ecoregime"</span><span class="op">)</span></span>
<span><span class="co">#&gt; To cite 'ecoregime' in publications use:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Sánchez-Pinillos M, Kéfi S, De Cáceres M, Dakos V (2023). "Ecological</span></span>
<span><span class="co">#&gt;   dynamic regimes: Identification, characterization, and comparison."</span></span>
<span><span class="co">#&gt;   _Ecological Monographs_. &lt;https://doi.org/10.1002/ecm.1589&gt;.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Sánchez-Pinillos M (2023). _ecoregime: Analysis of Ecological Dynamic</span></span>
<span><span class="co">#&gt;   Regimes_. &lt;https://doi.org/10.5281/zenodo.7584943&gt;.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; To see these entries in BibTeX format, use 'print(&lt;citation&gt;,</span></span>
<span><span class="co">#&gt; bibtex=TRUE)', 'toBibtex(.)', or set</span></span>
<span><span class="co">#&gt; 'options(citation.bibtex.max=999)'.</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="assessing-ecological-dynamic-regimes">2. Assessing ecological dynamic regimes<a class="anchor" aria-label="anchor" href="#assessing-ecological-dynamic-regimes"></a>
</h2>
<div class="section level3">
<h3 id="identifying-the-reference-ecological-dynamic-regime">2.1. Identifying the reference ecological dynamic regime<a class="anchor" aria-label="anchor" href="#identifying-the-reference-ecological-dynamic-regime"></a>
</h3>
<p>To assess the ecological resilience of a system, we need to identify
its ecological dynamic regime (EDR) so it can be used as the reference
to compare the disturbed dynamics. That is, the EDR to which the
disturbed trajectories belonged before being disturbed.</p>
<p>Given a stability landscape composed of alternative dynamic regimes,
we can compute the dynamic dispersion (dDis) of the pre-disturbance
portion of the disturbed trajectories in relation to each alternative
EDR. The function <code><a href="../reference/EDR_metrics.html">dDis()</a></code> allows us to quantify the degree
of membership of any trajectory within an EDR. You can see more
information about <code><a href="../reference/EDR_metrics.html">dDis()</a></code> in
<code><a href="../articles/EDR_framework.html">vignette("EDR_framework")</a></code>.</p>
<p>In the data included in <code>ecoregime</code> (i.e.,
<code>EDR_data</code>), you will find three abundance matrices
corresponding to a set of community trajectories forming three
ecological dynamic regimes (EDR1, EDR2, EDR3). Additionally, you will
find an abundance matrix associated with three disturbed communities
(<code>EDR3_disturbed</code>). Assuming that EDR1, EDR2, and EDR3 are
three alternative dynamic regimes in a stability landscape, we will see
how <code><a href="../reference/EDR_metrics.html">dDis()</a></code> can be used to identify the EDR with which the
disturbed trajectories are associated.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Species abundances in undisturbed states of the disturbed trajectories</span></span>
<span><span class="co"># (Undisturbed states are identified by disturbed_states = 0)</span></span>
<span><span class="va">abun_undist</span> <span class="op">&lt;-</span> <span class="va">EDR_data</span><span class="op">$</span><span class="va">EDR3_disturbed</span><span class="op">$</span><span class="va">abundance</span><span class="op">[</span><span class="va">disturbed_states</span> <span class="op">==</span> <span class="fl">0</span><span class="op">]</span> </span>
<span><span class="va">selcols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">EDR_data</span><span class="op">$</span><span class="va">EDR1</span><span class="op">$</span><span class="va">abundance</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## EDR1 ------------------------------------------------------------------------</span></span>
<span></span>
<span><span class="co"># Species abundances in EDR1 and the undisturbed states of disturbed trajectories</span></span>
<span><span class="va">abun1_undist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">EDR_data</span><span class="op">$</span><span class="va">EDR1</span><span class="op">$</span><span class="va">abundance</span>, <span class="va">abun_undist</span><span class="op">[</span>, <span class="va">..selcols</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># State dissimilarities in EDR1 and the undisturbed states of disturbed trajectories</span></span>
<span><span class="va">d1_undist</span> <span class="op">&lt;-</span> <span class="fu">vegan</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/vegan/man/vegdist.html" class="external-link">vegdist</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">abun1_undist</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"sp"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span><span class="op">]</span>, method <span class="op">=</span> <span class="st">"bray"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># dDis of the disturbed trajectories in relation to EDR1</span></span>
<span><span class="va">dDis1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">abun_undist</span><span class="op">$</span><span class="va">traj</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">iundist</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/EDR_metrics.html">dDis</a></span><span class="op">(</span>d <span class="op">=</span> <span class="va">d1_undist</span>, d.type <span class="op">=</span> <span class="st">"dStates"</span>, </span>
<span>       trajectories <span class="op">=</span> <span class="va">abun1_undist</span><span class="op">$</span><span class="va">traj</span>, states <span class="op">=</span> <span class="va">abun1_undist</span><span class="op">$</span><span class="va">state</span>, </span>
<span>       reference <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">iundist</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## EDR2 ------------------------------------------------------------------------</span></span>
<span></span>
<span><span class="co"># Species abundances in EDR2 and the undisturbed states of disturbed trajectories</span></span>
<span><span class="va">abun2_undist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">EDR_data</span><span class="op">$</span><span class="va">EDR2</span><span class="op">$</span><span class="va">abundance</span>, <span class="va">abun_undist</span><span class="op">[</span>, <span class="va">..selcols</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># State dissimilarities in EDR2 and the undisturbed states of disturbed trajectories</span></span>
<span><span class="va">d2_undist</span> <span class="op">&lt;-</span> <span class="fu">vegan</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/vegan/man/vegdist.html" class="external-link">vegdist</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">abun2_undist</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"sp"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span><span class="op">]</span>, method <span class="op">=</span> <span class="st">"bray"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># dDis of the disturbed trajectories in relation to EDR2</span></span>
<span><span class="va">dDis2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">abun_undist</span><span class="op">$</span><span class="va">traj</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">iundist</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/EDR_metrics.html">dDis</a></span><span class="op">(</span>d <span class="op">=</span> <span class="va">d2_undist</span>, d.type <span class="op">=</span> <span class="st">"dStates"</span>, </span>
<span>       trajectories <span class="op">=</span> <span class="va">abun2_undist</span><span class="op">$</span><span class="va">traj</span>, states <span class="op">=</span> <span class="va">abun2_undist</span><span class="op">$</span><span class="va">state</span>, </span>
<span>       reference <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">iundist</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## EDR3 ------------------------------------------------------------------------</span></span>
<span></span>
<span><span class="co"># Species abundances in EDR3 and the undisturbed states of disturbed trajectories</span></span>
<span><span class="va">abun3_undist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">EDR_data</span><span class="op">$</span><span class="va">EDR3</span><span class="op">$</span><span class="va">abundance</span>, <span class="va">abun_undist</span><span class="op">[</span>, <span class="va">..selcols</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># State dissimilarities in EDR3 and the undisturbed states of disturbed trajectories</span></span>
<span><span class="va">d3_undist</span> <span class="op">&lt;-</span> <span class="fu">vegan</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/vegan/man/vegdist.html" class="external-link">vegdist</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">abun3_undist</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"sp"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span><span class="op">]</span>, method <span class="op">=</span> <span class="st">"bray"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># dDis of the disturbed trajectories in relation to EDR3</span></span>
<span><span class="va">dDis3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">abun_undist</span><span class="op">$</span><span class="va">traj</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">iundist</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/EDR_metrics.html">dDis</a></span><span class="op">(</span>d <span class="op">=</span> <span class="va">d3_undist</span>, d.type <span class="op">=</span> <span class="st">"dStates"</span>, </span>
<span>       trajectories <span class="op">=</span> <span class="va">abun3_undist</span><span class="op">$</span><span class="va">traj</span>, states <span class="op">=</span> <span class="va">abun3_undist</span><span class="op">$</span><span class="va">state</span>, </span>
<span>       reference <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">iundist</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Compare dynamic dispersion --------------------------------------------------</span></span>
<span></span>
<span><span class="co"># Compare dDis values for the three EDRs</span></span>
<span><span class="va">dDis_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>EDR1 <span class="op">=</span> <span class="va">dDis1</span>, EDR2 <span class="op">=</span> <span class="va">dDis2</span>, EDR3 <span class="op">=</span> <span class="va">dDis3</span><span class="op">)</span></span></code></pre></div>
<p>If we compare the values of dDis for each disturbed trajectory (ref.
31, ref. 32, ref. 33) and EDR (EDR1, EDR2, EDR3), we see that the lowest
dDis values are associated with EDR3. We can take EDR3 as the reference
to assess the ecological resilience of the three disturbed
communities.</p>
<table class="table">
<thead><tr class="header">
<th align="left"></th>
<th align="right">EDR1</th>
<th align="right">EDR2</th>
<th align="right">EDR3</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">dDis (ref. 31)</td>
<td align="right">0.649</td>
<td align="right">0.748</td>
<td align="right">0.356</td>
</tr>
<tr class="even">
<td align="left">dDis (ref. 32)</td>
<td align="right">0.734</td>
<td align="right">0.556</td>
<td align="right">0.268</td>
</tr>
<tr class="odd">
<td align="left">dDis (ref. 33)</td>
<td align="right">0.711</td>
<td align="right">0.436</td>
<td align="right">0.412</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="define-the-main-dynamic-trends-through-representative-trajectories">2.2. Define the main dynamic trends through representative
trajectories<a class="anchor" aria-label="anchor" href="#define-the-main-dynamic-trends-through-representative-trajectories"></a>
</h3>
<p>Once we have identified the EDR of reference, we can compute the
representative trajectories using the function <code><a href="../reference/retra_edr.html">retra_edr()</a></code>.
See <code><a href="../articles/EDR_framework.html">vignette("EDR_framework")</a></code> for more information.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># State dissimilarities for EDR3 (considering only the undisturbed trajectories)</span></span>
<span><span class="va">d_EDR3</span> <span class="op">&lt;-</span> <span class="fu">vegan</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/vegan/man/vegdist.html" class="external-link">vegdist</a></span><span class="op">(</span><span class="va">EDR_data</span><span class="op">$</span><span class="va">EDR3</span><span class="op">$</span><span class="va">abundance</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"sp"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Representative trajectories</span></span>
<span><span class="va">retra</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/retra_edr.html">retra_edr</a></span><span class="op">(</span>d <span class="op">=</span> <span class="va">d_EDR3</span>, </span>
<span>                   trajectories <span class="op">=</span> <span class="va">EDR_data</span><span class="op">$</span><span class="va">EDR3</span><span class="op">$</span><span class="va">abundance</span><span class="op">$</span><span class="va">traj</span>,</span>
<span>                   states <span class="op">=</span> <span class="va">EDR_data</span><span class="op">$</span><span class="va">EDR3</span><span class="op">$</span><span class="va">abundance</span><span class="op">$</span><span class="va">state</span>, minSegs <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in rgl.init(initValue, onlyNULL): RGL: unable to open X11 display</span></span>
<span><span class="co">#&gt; Warning: 'rgl.init' failed, running with 'rgl.useNULL = TRUE'.</span></span></code></pre></div>
<p>Although there are five representative trajectories, we will select
“T4” as the reference for being the longest and covering all regions of
the EDR relatively well.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Summarize retra</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">retra</span><span class="op">)</span></span>
<span><span class="co">#&gt;    ID Size     Length   Avg_link   Sum_link Avg_density Max_density Avg_depth</span></span>
<span><span class="co">#&gt; T1 T1    8 0.56912543 0.12435644 0.24871287    7.250000           8  4.750000</span></span>
<span><span class="co">#&gt; T2 T2    6 0.39900498 0.10718905 0.21437811    7.666667           8  4.666667</span></span>
<span><span class="co">#&gt; T3 T3    4 0.08970149 0.03482587 0.03482587    6.500000           7  6.500000</span></span>
<span><span class="co">#&gt; T4 T4   16 1.11654181 0.08961127 0.53766760    6.625000           8  5.125000</span></span>
<span><span class="co">#&gt; T5 T5    6 0.35468137 0.08723881 0.17447761    7.333333          10  5.333333</span></span>
<span><span class="co">#&gt;    Max_depth</span></span>
<span><span class="co">#&gt; T1         6</span></span>
<span><span class="co">#&gt; T2         6</span></span>
<span><span class="co">#&gt; T3         7</span></span>
<span><span class="co">#&gt; T4         7</span></span>
<span><span class="co">#&gt; T5         7</span></span>
<span></span>
<span><span class="co"># Define T4 as the unique representative trajectory and generate an object of class 'RETRA'</span></span>
<span><span class="va">retra_ref</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/define_retra.html">define_retra</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">retra</span><span class="op">$</span><span class="va">T4</span><span class="op">$</span><span class="va">Segments</span>, d <span class="op">=</span> <span class="va">d_EDR3</span>, </span>
<span>                          trajectories <span class="op">=</span> <span class="va">EDR_data</span><span class="op">$</span><span class="va">EDR3</span><span class="op">$</span><span class="va">abundance</span><span class="op">$</span><span class="va">traj</span>, </span>
<span>                          states <span class="op">=</span> <span class="va">EDR_data</span><span class="op">$</span><span class="va">EDR3</span><span class="op">$</span><span class="va">abundance</span><span class="op">$</span><span class="va">state</span>,</span>
<span>                          retra <span class="op">=</span> <span class="va">retra</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot EDR3 and its representative trajectories</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">retra</span>, d <span class="op">=</span> <span class="va">d_EDR3</span>, </span>
<span>     trajectories <span class="op">=</span> <span class="va">EDR_data</span><span class="op">$</span><span class="va">EDR3</span><span class="op">$</span><span class="va">abundance</span><span class="op">$</span><span class="va">traj</span>, </span>
<span>     states <span class="op">=</span> <span class="va">EDR_data</span><span class="op">$</span><span class="va">EDR3</span><span class="op">$</span><span class="va">abundance</span><span class="op">$</span><span class="va">state</span>, select_RT <span class="op">=</span> <span class="st">"T4"</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Representative trajectories in EDR3"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topleft"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Representative trajectory 'T4'"</span>, </span>
<span>                    <span class="st">"Other representative trajectories"</span>, </span>
<span>                    <span class="st">"Individual trajectories in EDR3"</span><span class="op">)</span>,</span>
<span>       lty <span class="op">=</span> <span class="fl">1</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"black"</span>, <span class="st">"grey"</span><span class="op">)</span>, bty <span class="op">=</span> <span class="st">"n"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Resilience_files/figure-html/plot_retra-1.png" width="576"></p>
</div>
</div>
<div class="section level2">
<h2 id="metrics-of-ecological-resilience-to-pulse-disturbances">3. Metrics of ecological resilience to pulse disturbances<a class="anchor" aria-label="anchor" href="#metrics-of-ecological-resilience-to-pulse-disturbances"></a>
</h2>
<p>When an ecological system is disturbed, its dynamics can deviate from
the reference EDR and its representative trajectories. Depending on the
immediate impact of the disturbance and the changes in the state
variables following the release of the disturbance, post-disturbance
trajectories can be characterized through four complementary indices:
resistance (<em>Rt</em>), amplitude (<em>A</em>), recovery
(<em>Rc</em>), and net change (<em>NC</em>).</p>
<p><img src="Resilience_files/figure-html/graphical_indices-1.png" width="576"></p>
<div class="section level3">
<h3 id="resistance">3.1. Resistance<a class="anchor" aria-label="anchor" href="#resistance"></a>
</h3>
<p>The resistance index (<em>Rt</em>) quantifies the impact of the
disturbance on the system based on the immediate changes in the state
variables. That is, it is a measure of how similar the disturbed (1) and
the pre-disturbance (0) states are (Sánchez-Pinillos et al., 2019). As
such, the resistance index does not depend on the position of the system
within the EDR.</p>
<p><span class="math display">\[Rt = 1 - d_{pre, dist}\]</span></p>
<p>where <span class="math inline">\(d_{pre,dist}\)</span> is the
dissimilarity between the pre-disturbance (0) and the disturbed (1)
states.</p>
<p><img src="Resilience_files/figure-html/graphical_resistance-1.png" width="576"></p>
<p>Given the three disturbed trajectories in EDR3 (i.e.,
<code>EDR3_disturbed</code>), we can compute the resistance index using
the function <code><a href="../reference/deviation_metrics.html">resistance()</a></code>:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># To calculate resistance, we need a state dissimilarity matrix for the disturbed trajectories</span></span>
<span><span class="va">d_disturbed</span> <span class="op">&lt;-</span> <span class="fu">vegan</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/vegan/man/vegdist.html" class="external-link">vegdist</a></span><span class="op">(</span><span class="va">EDR_data</span><span class="op">$</span><span class="va">EDR3_disturbed</span><span class="op">$</span><span class="va">abundance</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"sp"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span><span class="op">]</span>, </span>
<span>                              method <span class="op">=</span> <span class="st">"bray"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compute resistance</span></span>
<span><span class="co"># Note that the disturbed states are identified by disturbed_states = 1</span></span>
<span><span class="va">Rt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/deviation_metrics.html">resistance</a></span><span class="op">(</span>d <span class="op">=</span> <span class="va">d_disturbed</span>, </span>
<span>                 trajectories <span class="op">=</span> <span class="va">EDR_data</span><span class="op">$</span><span class="va">EDR3_disturbed</span><span class="op">$</span><span class="va">abundance</span><span class="op">$</span><span class="va">traj</span>, </span>
<span>                 states <span class="op">=</span> <span class="va">EDR_data</span><span class="op">$</span><span class="va">EDR3_disturbed</span><span class="op">$</span><span class="va">abundance</span><span class="op">$</span><span class="va">state</span>, </span>
<span>                 disturbed_trajectories <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">EDR_data</span><span class="op">$</span><span class="va">EDR3_disturbed</span><span class="op">$</span><span class="va">abundance</span><span class="op">$</span><span class="va">traj</span><span class="op">)</span>, </span>
<span>                 disturbed_states <span class="op">=</span> <span class="va">EDR_data</span><span class="op">$</span><span class="va">EDR3_disturbed</span><span class="op">$</span><span class="va">abundance</span><span class="op">[</span><span class="va">disturbed_states</span> <span class="op">==</span> <span class="fl">1</span><span class="op">]</span><span class="op">$</span><span class="va">state</span><span class="op">)</span></span></code></pre></div>
<p>The three hypothetical systems show a relatively high resistance
(close to 1) to the disturbance:</p>
<table class="table">
<thead><tr class="header">
<th align="right">Disturbed trajectories</th>
<th align="right">Rt</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">31</td>
<td align="right">0.958</td>
</tr>
<tr class="even">
<td align="right">32</td>
<td align="right">0.812</td>
</tr>
<tr class="odd">
<td align="right">33</td>
<td align="right">0.693</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="amplitude">3.2. Amplitude<a class="anchor" aria-label="anchor" href="#amplitude"></a>
</h3>
<p>The amplitude (<em>A</em>) quantifies how much the system is deviated
from its trajectory during the disturbance assuming that, in the absence
of disturbances, the system would keep a constant distance to a
representative trajectory taken as the reference.</p>
<p>The amplitude can be calculated in absolute terms as the difference
of the dissimilarity between the disturbed state (1) and the
representative trajectory (<span class="math inline">\(d_{dist,RT}\)</span>) and the dissimilarity
between the pre-disturbance state (0) and the representative trajectory
(<span class="math inline">\(d_{pre,RT}\)</span>):</p>
<p><span class="math display">\[A_{abs} = d_{dist,RT} -
d_{pre,RT}\]</span></p>
<p>Alternatively, the amplitude can be calculated in relation to the
impact of the disturbance (<span class="math inline">\(d_{pre,dist}\)</span>). In this case, the
amplitude quantifies the ability of the system to remain close to the
representative trajectory in relation to the changes in the state
variables provoked by the disturbance.</p>
<p><span class="math display">\[A_{rel} = \frac{d_{dist,RT} -
d_{pre,RT}}{d_{pre,dist}}\]</span></p>
<p>In any case, positive amplitude values indicate that the system is
deviated towards the boundaries of the EDR, whereas negative values
indicate the deviation towards the representative trajectory taken as
the reference.</p>
<p><img src="Resilience_files/figure-html/graphical_amplitude-1.png" width="576"></p>
<p>Amplitude can be calculated using the function
<code><a href="../reference/deviation_metrics.html">amplitude()</a></code>:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># We need a state dissimilarity matrix containing the states of the disturbed </span></span>
<span><span class="co"># trajectories and the representative trajectory taken as the reference</span></span>
<span><span class="va">abun</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">EDR_data</span><span class="op">$</span><span class="va">EDR3</span><span class="op">$</span><span class="va">abundance</span>, <span class="va">EDR_data</span><span class="op">$</span><span class="va">EDR3_disturbed</span><span class="op">$</span><span class="va">abundance</span>, fill <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu">vegan</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/vegan/man/vegdist.html" class="external-link">vegdist</a></span><span class="op">(</span><span class="va">abun</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"sp"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span><span class="op">]</span>, method <span class="op">=</span> <span class="st">"bray"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compute amplitude</span></span>
<span><span class="va">A</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/deviation_metrics.html">amplitude</a></span><span class="op">(</span>d <span class="op">=</span> <span class="va">d</span>,</span>
<span>               trajectories <span class="op">=</span> <span class="va">abun</span><span class="op">$</span><span class="va">traj</span>,</span>
<span>               states <span class="op">=</span> <span class="va">abun</span><span class="op">$</span><span class="va">state</span>,</span>
<span>               disturbed_trajectories <span class="op">=</span> <span class="va">abun</span><span class="op">[</span><span class="va">disturbed_states</span> <span class="op">==</span> <span class="fl">1</span><span class="op">]</span><span class="op">$</span><span class="va">traj</span>,</span>
<span>               disturbed_states <span class="op">=</span> <span class="va">abun</span><span class="op">[</span><span class="va">disturbed_states</span> <span class="op">==</span> <span class="fl">1</span><span class="op">]</span><span class="op">$</span><span class="va">state</span>,</span>
<span>               reference <span class="op">=</span> <span class="va">retra_ref</span>, method <span class="op">=</span> <span class="st">"nearest_state"</span><span class="op">)</span></span></code></pre></div>
<p>The three considered systems show positive amplitude values,
indicating that the disturbance lead them towards the boundaries of the
EDR. Whereas the absolute amplitude of trajectory 31 (<span class="math inline">\(A_{abs}(31) = 0.027\)</span>) is smaller than the
absolute amplitude of trajectory 32 (<span class="math inline">\(A_{rel}(32) = 0.119\)</span>), both have similar
relative values (<span class="math inline">\(A_{rel}(31) =
0.653\)</span>; <span class="math inline">\(A_{rel}(32) =
0.631\)</span>). This result indicates that despite the small deviation
of trajectory 31 from the representative trajectory during the
disturbance, such deviation is disproportionately high in relation to
the impact of the disturbance on the state variables.</p>
<table class="table">
<thead><tr class="header">
<th align="right">Disturbed trajectories</th>
<th align="left">Reference</th>
<th align="right">A<sub>abs</sub>
</th>
<th align="right">A<sub>rel</sub>
</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">31</td>
<td align="left">T4.1</td>
<td align="right">0.027</td>
<td align="right">0.653</td>
</tr>
<tr class="even">
<td align="right">32</td>
<td align="left">T4.1</td>
<td align="right">0.119</td>
<td align="right">0.631</td>
</tr>
<tr class="odd">
<td align="right">33</td>
<td align="left">T4.1</td>
<td align="right">0.268</td>
<td align="right">0.871</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="recovery">3.3. Recovery<a class="anchor" aria-label="anchor" href="#recovery"></a>
</h3>
<p>The recovery index (<em>Rc</em>) quantifies the ability of the system
to reorganize itself after a disturbance and evolve towards the
representative trajectory representing its dominant dynamic trends.</p>
<p>The recovery can be calculated in absolute terms as the difference of
the dissimilarity between the disturbed state (1) and the representative
trajectory (<span class="math inline">\(d_{dist,RT}\)</span>) and the
dissimilarity between one of the post-disturbance states (&gt; 1) and
the representative trajectory (<span class="math inline">\(d_{post,RT}\)</span>):</p>
<p><span class="math display">\[Rc_{abs} = d_{dist,RT} -
d_{post,RT}\]</span></p>
<p>Alternatively, the recovery can be calculated in relation to the
changes in the state variables that the system must perform to return
towards the representative trajectory from the disturbed state (<span class="math inline">\(d_{dist, post}\)</span>). In this case, the index
penalizes the systems that require major restructuring of the state
variables to return towards the representative trajectory (positive
recovery) and gives less negative values to the systems minimizing the
escape from the dynamic regime through major changes in its state
variables.</p>
<p><span class="math display">\[Rc_{rel} = \frac{d_{dist,RT} -
d_{post,RT}}{d_{dist, post}}\]</span></p>
<p>Both absolute and relative recovery indices are positive when the
system evolves towards the representative trajectory. Otherwise,
negative values indicate that the system evolves towards the boundaries
of the EDR.</p>
<p><img src="Resilience_files/figure-html/graphical_recovery-1.png" width="576"></p>
<p><img src="Resilience_files/figure-html/graphical_recovery2-1.png" width="576"></p>
<p>Recovery can be calculated using the function <code><a href="../reference/deviation_metrics.html">recovery()</a></code>
considering all states after the disturbed state (&gt; 1):</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compute recovery using the same data used for amplitude</span></span>
<span><span class="va">Rc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/deviation_metrics.html">recovery</a></span><span class="op">(</span>d <span class="op">=</span> <span class="va">d</span>, </span>
<span>               trajectories <span class="op">=</span> <span class="va">abun</span><span class="op">$</span><span class="va">traj</span>,</span>
<span>               states <span class="op">=</span> <span class="va">abun</span><span class="op">$</span><span class="va">state</span>, </span>
<span>               disturbed_trajectories <span class="op">=</span> <span class="va">abun</span><span class="op">[</span><span class="va">disturbed_states</span> <span class="op">==</span> <span class="fl">1</span><span class="op">]</span><span class="op">$</span><span class="va">traj</span>,</span>
<span>               disturbed_states <span class="op">=</span> <span class="va">abun</span><span class="op">[</span><span class="va">disturbed_states</span> <span class="op">==</span> <span class="fl">1</span><span class="op">]</span><span class="op">$</span><span class="va">state</span>, </span>
<span>               reference <span class="op">=</span> <span class="va">retra_ref</span>, method <span class="op">=</span> <span class="st">"nearest_state"</span><span class="op">)</span></span></code></pre></div>
<p>We can plot the variation of recovery over time considering all
post-disturbance states:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Number of states after the disturbed state</span></span>
<span><span class="va">Rc</span> <span class="op">&lt;-</span> <span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></span><span class="op">(</span><span class="va">Rc</span><span class="op">)</span></span>
<span><span class="va">Rc</span><span class="op">[</span>, <span class="va">ID_post</span> <span class="op">:=</span> <span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">.N</span><span class="op">)</span>, by <span class="op">=</span> <span class="va">disturbed_trajectories</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Plot absolute recovery over time</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">Rc</span><span class="op">$</span><span class="va">ID_post</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">Rc</span><span class="op">$</span><span class="va">Rc_abs</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"n"</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Nb. states after disturbance"</span>, ylab <span class="op">=</span> <span class="st">"Absolute recovery"</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Variation of absolute recovery"</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">Rc</span><span class="op">$</span><span class="va">disturbed_trajectories</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">Rc</span><span class="op">[</span><span class="va">disturbed_trajectories</span> <span class="op">==</span> <span class="va">i</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ID_post"</span>, <span class="st">"Rc_abs"</span><span class="op">)</span><span class="op">]</span>,</span>
<span>        col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">Rc</span><span class="op">$</span><span class="va">disturbed_trajectories</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">i</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"bottomleft"</span>, legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">Rc</span><span class="op">$</span><span class="va">disturbed_trajectories</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">1</span>, </span>
<span>       col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">Rc</span><span class="op">$</span><span class="va">disturbed_trajectories</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span>, bty <span class="op">=</span> <span class="st">"n"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Resilience_files/figure-html/plot_recovery-1.png" width="576"></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Plot relative recovery over time</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">Rc</span><span class="op">$</span><span class="va">ID_post</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">Rc</span><span class="op">$</span><span class="va">Rc_rel</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"n"</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Nb. states after disturbance"</span>, ylab <span class="op">=</span> <span class="st">"Relative recovery"</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Variation of relative recovery"</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">Rc</span><span class="op">$</span><span class="va">disturbed_trajectories</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">Rc</span><span class="op">[</span><span class="va">disturbed_trajectories</span> <span class="op">==</span> <span class="va">i</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ID_post"</span>, <span class="st">"Rc_rel"</span><span class="op">)</span><span class="op">]</span>,</span>
<span>        col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">Rc</span><span class="op">$</span><span class="va">disturbed_trajectories</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">i</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topright"</span>, legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">Rc</span><span class="op">$</span><span class="va">disturbed_trajectories</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">1</span>, </span>
<span>       col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">Rc</span><span class="op">$</span><span class="va">disturbed_trajectories</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span>, bty <span class="op">=</span> <span class="st">"n"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Resilience_files/figure-html/plot_recovery-2.png" width="576"></p>
</div>
<div class="section level3">
<h3 id="net-change">3.4. Net change<a class="anchor" aria-label="anchor" href="#net-change"></a>
</h3>
<p>Net change (<em>NC</em>) quantifies how much the system is deviated
from its trajectory after the release of the disturbance assuming that,
in the absence of disturbances, the system would keep a constant
distance to a representative trajectory taken as the reference.</p>
<p>Like amplitude and recovery, net change can be calculated in absolute
or relative terms. The absolute net change is expressed as the
difference of the dissimilarity between one of the post-disturbance
states (&gt; 1) and the representative trajectory (<span class="math inline">\(d_{post,RT}\)</span>) and the dissimilarity
between the pre-disturbance state (0) and the representative trajectory
(<span class="math inline">\(d_{pre,RT}\)</span>):</p>
<p><span class="math display">\[NC_{abs} = d_{post,RT} -
d_{pre,RT}\]</span></p>
<p>The relative net change is calculated in relation to the changes
produced in the state variables between the pre-disturbance and the
post-disturbance states (<span class="math inline">\(d_{pre,post}\)</span>). In this way, the index
penalizes the systems that deviated from the expected trajectory despite
being very similar to the pre-disturbance state.</p>
<p><span class="math display">\[NC_{rel} = \frac{d_{post,RT} -
d_{pre,RT}}{d_{pre,post}}\]</span></p>
<p>As in the amplitude index, positive values indicate that the system
is deviated towards the boundaries of the EDR and negative values
indicate the deviation towards the representative trajectory taken as
the reference.</p>
<p><img src="Resilience_files/figure-html/graphical_NetChange-1.png" width="576"></p>
<p>The function <code><a href="../reference/deviation_metrics.html">net_change()</a></code> included in
<code>ecoregime</code> can be used to calculate the net change of all
post-disturbance states in relation to the pre-disturbance state:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compute net change using the same data used for amplitude</span></span>
<span><span class="va">NC</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/deviation_metrics.html">net_change</a></span><span class="op">(</span>d <span class="op">=</span> <span class="va">d</span>, </span>
<span>                 trajectories <span class="op">=</span> <span class="va">abun</span><span class="op">$</span><span class="va">traj</span>,</span>
<span>                 states <span class="op">=</span> <span class="va">abun</span><span class="op">$</span><span class="va">state</span>,</span>
<span>                 disturbed_trajectories <span class="op">=</span> <span class="va">abun</span><span class="op">[</span><span class="va">disturbed_states</span> <span class="op">==</span> <span class="fl">1</span><span class="op">]</span><span class="op">$</span><span class="va">traj</span>,</span>
<span>                 disturbed_states <span class="op">=</span> <span class="va">abun</span><span class="op">[</span><span class="va">disturbed_states</span> <span class="op">==</span> <span class="fl">1</span><span class="op">]</span><span class="op">$</span><span class="va">state</span>,</span>
<span>                 reference <span class="op">=</span> <span class="va">retra_ref</span>, method <span class="op">=</span> <span class="st">"nearest_state"</span><span class="op">)</span></span></code></pre></div>
<p>We can plot the variation of net change over time considering all
post-disturbance states:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># ID post-disturbance states</span></span>
<span><span class="va">NC</span> <span class="op">&lt;-</span> <span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></span><span class="op">(</span><span class="va">NC</span><span class="op">)</span></span>
<span><span class="va">NC</span><span class="op">[</span>, <span class="va">ID_post</span> <span class="op">:=</span> <span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">.N</span><span class="op">)</span>, by <span class="op">=</span> <span class="va">disturbed_trajectories</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Plot absolute net change over time</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">NC</span><span class="op">$</span><span class="va">ID_post</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">NC</span><span class="op">$</span><span class="va">NC_abs</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"n"</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Nb. states after disturbance"</span>, ylab <span class="op">=</span> <span class="st">"Absolute net change"</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Variation of absolute net change"</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">NC</span><span class="op">$</span><span class="va">disturbed_trajectories</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">NC</span><span class="op">[</span><span class="va">disturbed_trajectories</span> <span class="op">==</span> <span class="va">i</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ID_post"</span>, <span class="st">"NC_abs"</span><span class="op">)</span><span class="op">]</span>,</span>
<span>        col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">NC</span><span class="op">$</span><span class="va">disturbed_trajectories</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">i</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topleft"</span>, legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">NC</span><span class="op">$</span><span class="va">disturbed_trajectories</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">1</span>, </span>
<span>       col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">NC</span><span class="op">$</span><span class="va">disturbed_trajectories</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span>, bty <span class="op">=</span> <span class="st">"n"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Resilience_files/figure-html/plot_NetChange-1.png" width="576"></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Plot relative net change over time</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">NC</span><span class="op">$</span><span class="va">ID_post</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">NC</span><span class="op">$</span><span class="va">NC_rel</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"n"</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Nb. states after disturbance"</span>, ylab <span class="op">=</span> <span class="st">"Relative net change"</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Variation of relative net change"</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">NC</span><span class="op">$</span><span class="va">disturbed_trajectories</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">NC</span><span class="op">[</span><span class="va">disturbed_trajectories</span> <span class="op">==</span> <span class="va">i</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ID_post"</span>, <span class="st">"NC_rel"</span><span class="op">)</span><span class="op">]</span>,</span>
<span>        col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">NC</span><span class="op">$</span><span class="va">disturbed_trajectories</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">i</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"bottomleft"</span>, legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">NC</span><span class="op">$</span><span class="va">disturbed_trajectories</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">1</span>, </span>
<span>       col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">NC</span><span class="op">$</span><span class="va">disturbed_trajectories</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span>, bty <span class="op">=</span> <span class="st">"n"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Resilience_files/figure-html/plot_NetChange-2.png" width="576"></p>
</div>
</div>
<div class="section level2">
<h2 id="assessing-the-ecological-resilience-of-systems-affected-by-pulse-disturbances">4. Assessing the ecological resilience of systems affected by pulse
disturbances<a class="anchor" aria-label="anchor" href="#assessing-the-ecological-resilience-of-systems-affected-by-pulse-disturbances"></a>
</h2>
<p>Altogether, the metrics of amplitude, recovery, and net change define
the geometry of disturbed trajectories in relation to the reference EDR.
Additionally, the resistance index helps interpret the response of the
system considering the immediate impact of the disturbance.</p>
<p>As an example, we will take the three disturbed trajectories used in
the previous section. For simplicity, we will only focus on resistance
and the absolute values of amplitude, recovery, and net change and we
will consider the 14th post-disturbance state (last post-disturbance
state of <em>Trajectory 33</em>) of all trajectories to calculate
recovery and net change.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Merge the results for resistance, amplitude, recovery, and net change</span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Reduce</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, all <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>                  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">Rt</span>, <span class="va">A</span>, <span class="va">Rc</span>, <span class="va">NC</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="va">results</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">ID_post</span> <span class="op">==</span> <span class="fl">14</span><span class="op">)</span>, </span>
<span>                   <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"disturbed_trajectories"</span>, <span class="st">"Rt"</span>, <span class="st">"A_abs"</span>, <span class="st">"Rc_abs"</span>, <span class="st">"NC_abs"</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">Disturbed trajectories</th>
<th align="right">Rt</th>
<th align="right">A<sub>abs</sub>
</th>
<th align="right">Rc<sub>abs</sub>
</th>
<th align="right">NC<sub>abs</sub>
</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">31</td>
<td align="right">0.958</td>
<td align="right">0.027</td>
<td align="right">-0.474</td>
<td align="right">0.502</td>
</tr>
<tr class="even">
<td align="right">32</td>
<td align="right">0.812</td>
<td align="right">0.119</td>
<td align="right">0.099</td>
<td align="right">0.020</td>
</tr>
<tr class="odd">
<td align="right">33</td>
<td align="right">0.693</td>
<td align="right">0.268</td>
<td align="right">0.283</td>
<td align="right">-0.016</td>
</tr>
</tbody>
</table>
<p>Based on the values of the indices, we can figure out the shape of
the disturbed trajectories. For example, <em>Trajectory 31</em> was very
resistant to the immediate impact of the disturbance (in terms of
changes in the state variables) (<span class="math inline">\(Rt =
0.958\)</span>) and the amplitude provoked by the disturbance was very
small (<span class="math inline">\(A = 0.027\)</span>). However, unlike
<em>Trajectory 32</em> and <em>Trajectory 33</em>, the recovery was
negative (<span class="math inline">\(Rc = -0.474\)</span>) and the net
change positive and relatively high (<span class="math inline">\(NC =
0.502\)</span>). Thus, despite the relatively low impact of the
disturbance, the values of recovery and net change indicate that
<em>Trajectory 31</em> goes away from the reference EDR and the system
potentially changes to an alternative dynamic regime.</p>
<p>Both <em>Trajectory 32</em> and <em>Trajectory 33</em> showed
positive values of recovery and net change values close to zero. In both
cases, amplitude and recovery have similar values, respectively
(<em>Trajectory 32:</em> <span class="math inline">\(A = 0.119\)</span>,
<span class="math inline">\(Rc = 0.099\)</span>; <em>Trajectory 33:</em>
<span class="math inline">\(A = 0.268\)</span>, <span class="math inline">\(Rc = 0.283\)</span>), indicating that these
systems are able to reorganize and remain within the EDR.</p>
<p><em>Trajectory 32</em> was relatively resistant to the impact of the
disturbance (<span class="math inline">\(Rt = 0.812\)</span>) and showed
a relatively low deviation from the representative trajectory (<span class="math inline">\(A = 0.119\)</span>). In contrast, <em>Trajectory
33</em> was more severely impacted by the disturbance (<span class="math inline">\(Rt = 0.693\)</span>; <span class="math inline">\(A
= 0.268\)</span>) but showed a high recovery capacity (<span class="math inline">\(Rc = 0.283\)</span>). Thus, while both communities
could be considered resilient, they showed different strategies. Whereas
<em>Trajectory 32</em> represents a resistant dynamic within the EDR,
<em>Trajectory 33</em> represents a more variable system whose dynamics
visit the borders of the EDR to eventually return towards the
representative trajectory.</p>
<p>To support our evaluation of the ecological resilience of disturbed
trajectories, we can calculate the dynamic dispersion (dDis) of the
post-disturbance portion of the disturbed trajectories in relation to
the trajectories in the EDR.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Species abundances in post-disturbance states of the disturbed trajectories</span></span>
<span><span class="co"># The states after the release of the disturbance are identified by disturbed_states &gt; 1</span></span>
<span><span class="va">abun_post</span> <span class="op">&lt;-</span> <span class="va">EDR_data</span><span class="op">$</span><span class="va">EDR3_disturbed</span><span class="op">$</span><span class="va">abundance</span><span class="op">[</span><span class="va">disturbed_states</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">]</span> </span>
<span><span class="va">selcols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">EDR_data</span><span class="op">$</span><span class="va">EDR3</span><span class="op">$</span><span class="va">abundance</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Species abundances in EDR3 and the post-disturbance states of disturbed trajectories</span></span>
<span><span class="va">abun3_post</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">EDR_data</span><span class="op">$</span><span class="va">EDR3</span><span class="op">$</span><span class="va">abundance</span>, <span class="va">abun_post</span><span class="op">[</span>, <span class="va">..selcols</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># State dissimilarities in EDR3 and the post-disturbance states of disturbed trajectories</span></span>
<span><span class="va">d3_post</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="fu">vegan</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/vegan/man/vegdist.html" class="external-link">vegdist</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">abun3_post</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"sp"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span><span class="op">]</span>, method <span class="op">=</span> <span class="st">"bray"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># dDis of each disturbed trajectory</span></span>
<span><span class="va">dDis_dist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">abun_post</span><span class="op">$</span><span class="va">traj</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">idist</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">rm_disturbed</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">abun_post</span><span class="op">$</span><span class="va">traj</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">abun_post</span><span class="op">$</span><span class="va">traj</span> <span class="op">!=</span> <span class="va">idist</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">irm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">abun3_post</span><span class="op">$</span><span class="va">traj</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">rm_disturbed</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="../reference/EDR_metrics.html">dDis</a></span><span class="op">(</span>d <span class="op">=</span> <span class="va">d3_post</span><span class="op">[</span><span class="op">-</span><span class="va">irm</span>, <span class="op">-</span><span class="va">irm</span><span class="op">]</span>, d.type <span class="op">=</span> <span class="st">"dStates"</span>, </span>
<span>       trajectories <span class="op">=</span> <span class="va">abun3_post</span><span class="op">$</span><span class="va">traj</span><span class="op">[</span><span class="op">-</span><span class="va">irm</span><span class="op">]</span>, </span>
<span>       states <span class="op">=</span> <span class="va">abun3_post</span><span class="op">$</span><span class="va">state</span><span class="op">[</span><span class="op">-</span><span class="va">irm</span><span class="op">]</span>, </span>
<span>       reference <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">idist</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<p>The values of dDis confirm the resilience of <em>Trajectory 32</em>
and show that, despite being able to recover after the disturbance, the
dynamic represented by <em>Trajectory 33</em> is anomalous in relation
to the other dynamics in the EDR.</p>
<table class="table">
<thead><tr class="header">
<th align="right">Disturbed trajectories</th>
<th align="right">dDis</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">31</td>
<td align="right">0.463</td>
</tr>
<tr class="even">
<td align="right">32</td>
<td align="right">0.257</td>
</tr>
<tr class="odd">
<td align="right">33</td>
<td align="right">0.474</td>
</tr>
</tbody>
</table>
<p>Finally, we can illustrate the responses of the three disturbed
communities by representing their trajectories in relation to the
reference EDR and its representative trajectory:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot EDR3 and its representative trajectories</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">retra_ref</span>, d <span class="op">=</span> <span class="va">d</span>, </span>
<span>     trajectories <span class="op">=</span> <span class="va">abun</span><span class="op">$</span><span class="va">traj</span>, </span>
<span>     states <span class="op">=</span> <span class="va">abun</span><span class="op">$</span><span class="va">state</span>, </span>
<span>     traj.colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"grey"</span>, <span class="fl">30</span><span class="op">)</span>, <span class="fl">2</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span>, </span>
<span>     main <span class="op">=</span> <span class="st">"Comparison of disturbed trajectories and EDR3"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topleft"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Representative trajectory"</span>, </span>
<span>                    <span class="st">"Individual trajectories in EDR3"</span>,</span>
<span>                    <span class="st">"Trajectory 31"</span>,</span>
<span>                    <span class="st">"Trajectory 32"</span>,</span>
<span>                    <span class="st">"Trajectory 33"</span><span class="op">)</span>,</span>
<span>       lty <span class="op">=</span> <span class="fl">1</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"black"</span>, <span class="st">"grey"</span>, <span class="fl">2</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span>, bty <span class="op">=</span> <span class="st">"n"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Resilience_files/figure-html/plot_disturbed-1.png" width="672"></p>
</div>
<div class="section level2">
<h2 id="acknowledgements">Acknowledgements<a class="anchor" aria-label="anchor" href="#acknowledgements"></a>
</h2>
<p>This project has received funding from the European Union’s Horizon
2020 research and innovation program under the Marie Sklodowska-Curie
grant agreement No 891477 (RESET project).</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Martina Sánchez-Pinillos.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
