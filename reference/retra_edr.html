<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Representative trajectories in Ecological Dynamic Regimes (RETRA-EDR) — retra_edr • ecoregime</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Representative trajectories in Ecological Dynamic Regimes (RETRA-EDR) — retra_edr"><meta name="description" content="retra_edr() applies the algorithm RETRA-EDR (Sánchez-Pinillos et al., 2023)
to identify representative trajectories summarizing the main dynamical patterns
of an Ecological Dynamic Regime (EDR)."><meta property="og:description" content="retra_edr() applies the algorithm RETRA-EDR (Sánchez-Pinillos et al., 2023)
to identify representative trajectories summarizing the main dynamical patterns
of an Ecological Dynamic Regime (EDR)."><meta property="og:image" content="https://mspinillos.github.io/ecoregime/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ecoregime</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/EDR_framework.html">Ecological Dynamic Regime framework</a></li>
    <li><a class="dropdown-item" href="../articles/Resilience.html">Ecological resilience to pulse disturbances</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/MSPinillos/ecoregime/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Representative trajectories in Ecological Dynamic Regimes (RETRA-EDR)</h1>
      <small class="dont-index">Source: <a href="https://github.com/MSPinillos/ecoregime/blob/master/R/retra_edr.R" class="external-link"><code>R/retra_edr.R</code></a></small>
      <div class="d-none name"><code>retra_edr.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>retra_edr()</code> applies the algorithm RETRA-EDR (Sánchez-Pinillos et al., 2023)
to identify representative trajectories summarizing the main dynamical patterns
of an Ecological Dynamic Regime (EDR).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">retra_edr</span><span class="op">(</span></span>
<span>  <span class="va">d</span>,</span>
<span>  <span class="va">trajectories</span>,</span>
<span>  <span class="va">states</span>,</span>
<span>  <span class="va">minSegs</span>,</span>
<span>  dSegs <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  coordSegs <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  traj_Segs <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  state1_Segs <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  state2_Segs <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  Dim <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  eps <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-d">d<a class="anchor" aria-label="anchor" href="#arg-d"></a></dt>
<dd><p>Either a symmetric matrix or an object of class <code><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></code> containing the
dissimilarities between each pair of states of all trajectories in the EDR.</p></dd>


<dt id="arg-trajectories">trajectories<a class="anchor" aria-label="anchor" href="#arg-trajectories"></a></dt>
<dd><p>Vector indicating the trajectory or site to which each
state in <code>d</code> belongs.</p></dd>


<dt id="arg-states">states<a class="anchor" aria-label="anchor" href="#arg-states"></a></dt>
<dd><p>Vector of integers indicating the order of the states in <code>d</code> for
each trajectory.</p></dd>


<dt id="arg-minsegs">minSegs<a class="anchor" aria-label="anchor" href="#arg-minsegs"></a></dt>
<dd><p>Integer indicating the minimum number of segments in a region
of the EDR represented by a segment of the representative trajectory.</p></dd>


<dt id="arg-dsegs">dSegs<a class="anchor" aria-label="anchor" href="#arg-dsegs"></a></dt>
<dd><p>Either a symmetric matrix or an object of class <code><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></code> containing
the dissimilarities between every pair of trajectory segments (see Details).</p></dd>


<dt id="arg-coordsegs">coordSegs<a class="anchor" aria-label="anchor" href="#arg-coordsegs"></a></dt>
<dd><p>Matrix containing the coordinates of trajectory segments (rows)
in each axis (columns) of an ordination space (see Details).</p></dd>


<dt id="arg-traj-segs">traj_Segs<a class="anchor" aria-label="anchor" href="#arg-traj-segs"></a></dt>
<dd><p>Vector indicating the trajectory to which each segment in <code>dSeg</code>
and/or <code>coordSegs</code> belongs. Only required if <code>dSegs</code> or <code>coordSegs</code> are not <code>NULL</code>.</p></dd>


<dt id="arg-state-segs">state1_Segs<a class="anchor" aria-label="anchor" href="#arg-state-segs"></a></dt>
<dd><p>Vector indicating the initial state of each segment in <code>dSegs</code>
and/or <code>coordSegs</code> according to the values given in <code>states</code>. Only required if
<code>dSegs</code> or <code>coordSegs</code> are not <code>NULL</code>.</p></dd>


<dt id="arg-state-segs">state2_Segs<a class="anchor" aria-label="anchor" href="#arg-state-segs"></a></dt>
<dd><p>Vector indicating the final state of each segment in <code>dSegs</code>
and/or <code>coordSegs</code> according to the values given in <code>states</code>. Only required if
<code>dSegs</code> or <code>coordSegs</code> are not <code>NULL</code>.</p></dd>


<dt id="arg-dim">Dim<a class="anchor" aria-label="anchor" href="#arg-dim"></a></dt>
<dd><p>Optional integer indicating the number of axes considered to
partition the segment space and generate a k-d tree. By default (<code>Dim = NULL</code>),
all axes are considered.</p></dd>


<dt id="arg-eps">eps<a class="anchor" aria-label="anchor" href="#arg-eps"></a></dt>
<dd><p>Numeric value indicating the minimum length in the axes of the segment
space to be partitioned when the k-d tree is generated. If <code>eps = 0</code> (default),
partitions are made regardless of the size.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The function <code>retra_edr()</code> returns an object of class <code>RETRA</code>, which is a list
of length equal to the number of representative trajectories identified. For
each trajectory, the following information is returned:</p><dl><dt><code>minSegs</code></dt>
<dd><p>Value of the <code>minSegs</code> parameter.</p></dd>

<dt><code>Segments</code></dt>
<dd><p>Vector of strings including the sequence of segments forming the
representative trajectory. Each segment is identified by a string of the form
<code>traj[st1-st2]</code>, where <code>traj</code> is the identifier of the original trajectory to
which the segment belongs and <code>st1</code> and <code>st2</code> are identifiers of the initial
and final states defining the segment.</p></dd>

<dt><code>Size</code></dt>
<dd><p>Numeric value indicating the number of states forming the representative
trajectory.</p></dd>

<dt><code>Length</code></dt>
<dd><p>Numeric value indicating the length of the representative trajectory,
calculated as the sum of the dissimilarities in <code>d</code> between every pair of
consecutive states.</p></dd>

<dt><code>Link_distance</code></dt>
<dd><p>Data frame of two columns indicating artificial links between
representative segments (<code>Link</code>) and the dissimilarity between the connected
states (<code>Distance</code>). When two representative segments are linked by a common
state or by two consecutive states of the same trajectory, the link distance
is zero or equal to the length of a real segment, respectively. In both cases,
the link is not considered in the returned data frame.</p></dd>

<dt><code>Seg_density</code></dt>
<dd><p>Data frame of two columns and one row for each representative
segment. <code>Density</code> contains the number of segments in the EDR that is represented
by each segment of the representative trajectory. <code>kdTree_depth</code> contains the
depth of the k-d tree for each leaf represented by the corresponding segment.
That is, the number of partitions of the ordination space until finding a region
with <code>minSegs</code> segments or less.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The algorithm RETRA-EDR is based on a partition-and-group approach by which it
identifies regions densely crossed by ecological trajectories in an EDR, selects
a representative segment in each dense region, and joins the representative
segments by a set of artificial <code>Links</code> to generate a network of representative
trajectories. For that, RETRA-EDR splits the trajectories of the EDR into
segments and uses an ordination space generated from a matrix containing the
dissimilarities between trajectory segments. Dense regions are identified by
applying a k-d tree to the ordination space.</p>
<p>By default, RETRA-EDR calculates segment dissimilarities following the approach
by De Cáceres et al. (2019) and applies metric multidimensional scaling (mMDS,
Borg and Groenen, 2005) to generate the ordination space. It is possible to use
other dissimilarity metrics and/or ordination methods and reduce the computational
time by indicating the dissimilarity matrix and the coordinates of the segments
in the ordination space through the arguments <code>dSegs</code> and <code>coordSegs</code>, respectively.</p><ul><li><p>If <code>!is.null(dSegs)</code> and <code>is.null(coordSegs)</code>, RETRA-EDR is computed by
applying mMDS to <code>dSegs</code>.</p></li>
<li><p>If <code>!is.null(dSegs)</code> and <code>!is.null(coordSegs)</code>, RETRA-EDR is directly computed
from the coordinates provided in <code>coordSegs</code> and representative segments are
identified using <code>dSegs</code>. <code>coordSegs</code> should be calculated by the user from
<code>dSegs</code>.</p></li>
<li><p>If <code>is.null(dSegs)</code> and <code>!is.null(coordSegs)</code> (not recommended), RETRA-EDR
is directly computed from the coordinates provided in <code>coordSegs</code>. As <code>dSegs</code>
is not provided, <code>retra_edr()</code> assumes that the ordination space is metric and
identifies representative segments using the Euclidean distance.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Borg, I., &amp; Groenen, P. J. F. (2005). Modern Multidimensional Scaling (2nd ed.).
Springer.</p>
<p>De Cáceres, M, Coll L, Legendre P, Allen RB, Wiser SK, Fortin MJ,
Condit R &amp; Hubbell S. (2019). Trajectory analysis in community ecology. Ecological
Monographs.</p>
<p>Sánchez-Pinillos, M., Kéfi, S., De Cáceres, M., Dakos, V. 2023. Ecological Dynamic
Regimes: Identification, characterization, and comparison. <em>Ecological Monographs</em>.
<a href="doi:10.1002/ecm.1589">doi:10.1002/ecm.1589</a></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> for summarizing the characteristics of the representative
trajectories.</p>
<p><code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> for plotting representative trajectories in an ordination space
representing the state space of the EDR.</p>
<p><code><a href="define_retra.html">define_retra()</a></code> for defining representative trajectories from a subset of
segments or trajectory features.</p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Martina Sánchez-Pinillos</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Example 1 -----------------------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co"># Identify representative trajectories from state dissimilarities</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculate state dissimilarities (Bray-Curtis) from species abundances</span></span></span>
<span class="r-in"><span><span class="va">abundance</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">EDR_data</span><span class="op">$</span><span class="va">EDR1</span><span class="op">$</span><span class="va">abundance</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu">vegan</span><span class="fu">::</span><span class="fu"><a href="https://vegandevs.github.io/vegan/reference/vegdist.html" class="external-link">vegdist</a></span><span class="op">(</span><span class="va">abundance</span><span class="op">[</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">]</span>, method <span class="op">=</span> <span class="st">"bray"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Identify the trajectory (or site) and states in d</span></span></span>
<span class="r-in"><span><span class="va">trajectories</span> <span class="op">&lt;-</span> <span class="va">abundance</span><span class="op">$</span><span class="va">traj</span></span></span>
<span class="r-in"><span><span class="va">states</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">abundance</span><span class="op">$</span><span class="va">state</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compute RETRA-EDR</span></span></span>
<span class="r-in"><span><span class="va">RT1</span> <span class="op">&lt;-</span> <span class="fu">retra_edr</span><span class="op">(</span>d <span class="op">=</span> <span class="va">d</span>, trajectories <span class="op">=</span> <span class="va">trajectories</span>, states <span class="op">=</span> <span class="va">states</span>,</span></span>
<span class="r-in"><span>                 minSegs <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 2 -----------------------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co"># Identify representative trajectories from segment dissimilarities</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculate segment dissimilarities using the Hausdorff distance</span></span></span>
<span class="r-in"><span><span class="va">dSegs</span> <span class="op">&lt;-</span> <span class="fu">ecotraj</span><span class="fu">::</span><span class="fu"><a href="https://emf-creaf.github.io/ecotraj/reference/trajectoryComparison.html" class="external-link">segmentDistances</a></span><span class="op">(</span><span class="fu">ecotraj</span><span class="fu">::</span><span class="fu"><a href="https://emf-creaf.github.io/ecotraj/reference/defineTrajectories.html" class="external-link">defineTrajectories</a></span><span class="op">(</span>d <span class="op">=</span> <span class="va">d</span>, sites <span class="op">=</span> <span class="va">trajectories</span>,</span></span>
<span class="r-in"><span>                                                               surveys <span class="op">=</span> <span class="va">states</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                   distance.type <span class="op">=</span> <span class="st">"Hausdorff"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dSegs</span> <span class="op">&lt;-</span> <span class="va">dSegs</span><span class="op">$</span><span class="va">Dseg</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Identify the trajectory (or site) and states in dSegs:</span></span></span>
<span class="r-in"><span><span class="co"># Split the labels of dSegs (traj[st1-st2]) into traj, st1, and st2</span></span></span>
<span class="r-in"><span><span class="va">seg_components</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/strsplit.html" class="external-link">strsplit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"\\]"</span>, <span class="st">""</span>, <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"\\["</span>, <span class="st">"-"</span>, <span class="fu"><a href="https://rdrr.io/r/base/labels.html" class="external-link">labels</a></span><span class="op">(</span><span class="va">dSegs</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, <span class="st">"-"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">traj_Segs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">seg_components</span>, <span class="st">"["</span>, <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">state1_Segs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">seg_components</span>, <span class="st">"["</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">state2_Segs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">seg_components</span>, <span class="st">"["</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compute RETRA-EDR</span></span></span>
<span class="r-in"><span><span class="va">RT2</span> <span class="op">&lt;-</span> <span class="fu">retra_edr</span><span class="op">(</span>d <span class="op">=</span> <span class="va">d</span>, trajectories <span class="op">=</span> <span class="va">trajectories</span>, states <span class="op">=</span> <span class="va">states</span>, minSegs <span class="op">=</span> <span class="fl">5</span>,</span></span>
<span class="r-in"><span>                dSegs <span class="op">=</span> <span class="va">dSegs</span>, traj_Segs <span class="op">=</span> <span class="va">traj_Segs</span>,</span></span>
<span class="r-in"><span>                state1_Segs <span class="op">=</span> <span class="va">state1_Segs</span>, state2_Segs <span class="op">=</span> <span class="va">state2_Segs</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Martina Sánchez-Pinillos.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

